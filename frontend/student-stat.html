<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ‚Äî BBA PSU</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Anuphan:wght@300;400;500;600;700;800&family=Sarabun:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
*{box-sizing:border-box;margin:0;padding:0}
:root{
  --bg:#f4f1fb;
  --white:#ffffff;
  --sidebar:#2d1b69;
  --nav:#ffffff;
  --card:#ffffff;
  --border:#e8e1f5;
  --text:#1a0f2e;
  --text2:#5a4d7a;
  --muted:#9585b8;
  --acc:#7c3aed;
  --acc2:#8b5cf6;
  --acc3:#a78bfa;
  --acc-l:#ede9fe;
  --acc-ll:#f5f3ff;
  --sh:0 2px 12px rgba(109,40,217,.08),0 1px 3px rgba(0,0,0,.05);
  --sh2:0 8px 32px rgba(109,40,217,.12),0 2px 8px rgba(0,0,0,.06);
  --sh3:0 20px 60px rgba(109,40,217,.15),0 4px 12px rgba(0,0,0,.07);
}
html,body{height:100%;background:var(--bg);color:var(--text);font-family:'Sarabun',sans-serif;font-size:13.5px;overflow:hidden}
::-webkit-scrollbar{width:5px;height:5px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--border);border-radius:99px}
::-webkit-scrollbar-thumb:hover{background:var(--acc3)}

/* ‚îÄ‚îÄ TOPNAV ‚îÄ‚îÄ */
.topnav{
  position:fixed;top:0;left:0;right:0;z-index:300;
  height:56px;background:var(--nav);
  border-bottom:1px solid var(--border);
  box-shadow:0 1px 8px rgba(109,40,217,.07);
  display:flex;align-items:center;padding:0 20px;gap:12px;
}
.tn-logo{display:flex;align-items:center;gap:9px;text-decoration:none;flex-shrink:0;margin-right:12px}
.tn-badge{
  width:34px;height:34px;border-radius:9px;
  background:linear-gradient(135deg,var(--acc),#6d28d9);
  display:flex;align-items:center;justify-content:center;
  box-shadow:0 3px 10px rgba(109,40,217,.35);
  flex-shrink:0;overflow:hidden;
}
.tn-brand{font-family:'Anuphan',sans-serif;font-size:13px;font-weight:700;color:var(--text);line-height:1.25}
.tn-brand small{display:block;font-size:10px;font-weight:400;color:var(--muted)}
.tn-nav{display:flex;align-items:center;gap:2px;flex:1}
.tn-a{
  padding:6px 13px;border-radius:7px;font-size:12.5px;
  font-weight:500;color:var(--text2);cursor:pointer;
  white-space:nowrap;transition:all .15s;border:none;background:none;
  font-family:'Sarabun',sans-serif;
}
.tn-a:hover{background:var(--acc-l);color:var(--acc)}
.tn-a.active{background:var(--acc-l);color:var(--acc);font-weight:700}
.tn-r{display:flex;align-items:center;gap:8px;margin-left:auto;flex-shrink:0}
.tn-av{width:32px;height:32px;border-radius:50%;background:linear-gradient(135deg,var(--acc),#a855f7);display:flex;align-items:center;justify-content:center;font-weight:800;font-size:12px;color:#fff;cursor:pointer;box-shadow:0 2px 8px rgba(109,40,217,.3)}

/* ‚îÄ‚îÄ LAYOUT ‚îÄ‚îÄ */
.app{display:flex;height:100vh;padding-top:56px}
.sidebar{
  width:185px;flex-shrink:0;background:var(--sidebar);
  overflow-y:auto;padding:14px 10px;display:flex;flex-direction:column;gap:3px;
}
.sb-section{
  font-size:10px;font-weight:700;color:rgba(255,255,255,.35);
  text-transform:uppercase;letter-spacing:.8px;
  padding:8px 10px 5px;margin-top:8px;
}
.sb-section:first-child{margin-top:0}
.sb-item{
  display:flex;align-items:center;gap:9px;
  padding:8px 10px;border-radius:8px;
  cursor:pointer;font-size:12px;color:rgba(255,255,255,.55);
  transition:all .15s;
}
.sb-item svg{width:14px;height:14px;flex-shrink:0}
.sb-item:hover{background:rgba(255,255,255,.08);color:rgba(255,255,255,.9)}
.sb-item.active{background:rgba(255,255,255,.15);color:#fff;font-weight:600}
.content{flex:1;overflow-y:auto;background:var(--bg)}

/* ‚îÄ‚îÄ VIEWS ‚îÄ‚îÄ */
.view{display:none;padding:22px 24px 48px;min-height:100%}
.view.active{display:block}

/* ‚îÄ‚îÄ PAGE HEADER ‚îÄ‚îÄ */
.ph{margin-bottom:18px}
.ph-row{display:flex;align-items:flex-start;justify-content:space-between;gap:12px;flex-wrap:wrap}
.ph-title{font-family:'Anuphan',sans-serif;font-size:22px;font-weight:800;color:var(--text);line-height:1.25}
.ph-sub{font-size:11.5px;color:var(--muted);margin-top:3px;font-style:italic}

/* ‚îÄ‚îÄ BUTTONS ‚îÄ‚îÄ */
.btn{
  display:inline-flex;align-items:center;gap:6px;
  padding:7px 15px;border-radius:8px;
  font-family:'Sarabun',sans-serif;font-size:12.5px;font-weight:700;
  cursor:pointer;border:none;white-space:nowrap;transition:all .16s;
}
.btn svg{width:12px;height:12px;fill:currentColor;flex-shrink:0}
.btn-acc{background:var(--acc);color:#fff;box-shadow:0 3px 10px rgba(124,58,237,.3)}
.btn-acc:hover{background:#6d28d9;transform:translateY(-1px)}
.btn-out{background:#fff;color:var(--acc);border:1.5px solid #c4b5fd}
.btn-out:hover{background:var(--acc-l)}
.btn-ghost{background:rgba(0,0,0,.04);color:var(--text2);border:1px solid var(--border)}
.btn-ghost:hover{background:var(--acc-l);color:var(--acc)}
.btn-sm{padding:5px 11px;font-size:11.5px;border-radius:6px}
.btn-xs{padding:4px 9px;font-size:11px;border-radius:5px}

/* ‚îÄ‚îÄ FORM ‚îÄ‚îÄ */
.form-section{
  background:#fff;border-radius:12px;padding:18px 20px;
  border:1px solid var(--border);box-shadow:var(--sh);
  margin-bottom:14px;
}
.fs-header{
  display:flex;align-items:center;gap:9px;
  margin-bottom:14px;padding-bottom:11px;
  border-bottom:1px solid var(--border);
}
.fs-num{
  width:24px;height:24px;border-radius:6px;
  background:var(--acc);color:#fff;
  font-size:11px;font-weight:800;
  display:flex;align-items:center;justify-content:center;
  flex-shrink:0;
}
.fs-title{font-family:'Anuphan',sans-serif;font-size:14px;font-weight:700;color:var(--text)}
.fs-sub{font-size:11px;color:var(--muted);margin-top:1px}
.form-row{display:grid;gap:12px;margin-bottom:12px}
.form-row.c2{grid-template-columns:1fr 1fr}
.form-row.c3{grid-template-columns:1fr 1fr 1fr}
.form-row.c5{grid-template-columns:repeat(5,1fr)}
.fg label{display:block;font-size:11px;font-weight:600;color:var(--text2);margin-bottom:4px}
.fg label .req{color:#ef4444;margin-left:2px}
.fg input,.fg select{
  width:100%;padding:8px 11px;
  background:#fafafa;border:1.5px solid var(--border);
  border-radius:7px;font-family:'Sarabun',sans-serif;
  font-size:12.5px;color:var(--text);outline:none;
  transition:.15s;
}
.fg input:focus,.fg select:focus{border-color:var(--acc);background:#fff}
.fg .hint{font-size:10.5px;color:var(--muted);margin-top:3px}
.form-actions{display:flex;justify-content:flex-end;gap:8px;margin-top:14px;padding-top:12px;border-top:1px solid var(--border)}

/* ‚îÄ‚îÄ SAVED BOX ‚îÄ‚îÄ */
.saved-preview{
  background:var(--acc-ll);border:1px solid #c4b5fd;
  border-radius:9px;padding:12px 14px;margin-top:12px;
}
.sp-title{
  display:flex;align-items:center;gap:7px;
  font-size:12px;font-weight:700;color:var(--acc);
  margin-bottom:9px;
}
.sp-dot{width:7px;height:7px;border-radius:2px;background:var(--acc);flex-shrink:0}
.sp-vals{display:flex;gap:20px;flex-wrap:wrap}
.sp-item .sp-num{font-family:'Anuphan',sans-serif;font-size:22px;font-weight:800;color:var(--text);line-height:1}
.sp-item .sp-lbl{font-size:10.5px;color:var(--muted);margin-top:2px}

/* ‚îÄ‚îÄ TABLE ‚îÄ‚îÄ */
.tbl-wrap{border-radius:10px;overflow:auto;border:1px solid var(--border);box-shadow:var(--sh)}
table{width:100%;border-collapse:collapse;min-width:400px}
thead th{
  background:var(--acc-ll);font-size:11.5px;color:var(--text2);
  font-weight:700;padding:9px 12px;text-align:left;
  border-bottom:1px solid #c4b5fd;white-space:nowrap;
}
tbody td{padding:9px 12px;font-size:12.5px;border-bottom:1px solid var(--border);color:var(--text)}
tbody tr:last-child td{border-bottom:none}
tbody tr:hover td{background:var(--acc-ll)}

/* ‚îÄ‚îÄ DROP ZONE ‚îÄ‚îÄ */
.dz{
  border:2px dashed #c4b5fd;border-radius:10px;
  padding:24px 20px;text-align:center;cursor:pointer;transition:.18s;
  background:var(--acc-ll);
}
.dz:hover,.dz.drag{border-color:var(--acc);background:var(--acc-l)}
.dz-ico{font-size:28px;margin-bottom:8px}
.dz p{font-size:12.5px;color:var(--muted)}
.dz b{color:var(--acc);cursor:pointer}

/* ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ */
#toast{
  position:fixed;bottom:20px;right:20px;z-index:9999;
  background:var(--sidebar);color:#fff;
  padding:10px 18px;border-radius:10px;font-size:13px;font-weight:600;
  display:flex;align-items:center;gap:8px;
  box-shadow:var(--sh3);
  transform:translateY(60px);opacity:0;pointer-events:none;
  transition:all .3s cubic-bezier(.34,1.56,.64,1);
}
#toast.show{transform:none;opacity:1}
#toast .tdot{width:7px;height:7px;border-radius:50%;flex-shrink:0}
</style>
</head>
<body>

<header class="topnav">
  <a class="tn-logo" href="#">
    <div class="tn-badge">
      <img src="https://upload.wikimedia.org/wikipedia/en/thumb/4/4a/PSU_logo.png/200px-PSU_logo.png"
           onerror="this.style.display='none';this.parentNode.innerHTML='<span style=\'font-family:Anuphan,sans-serif;font-size:10px;font-weight:800;color:#fff\'>PSU</span>'"
           style="width:22px;height:22px;object-fit:contain">
    </div>
    <div class="tn-brand">
      ‡∏Ñ‡∏ì‡∏∞‡∏ß‡∏¥‡∏ó‡∏¢‡∏≤‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£
      <small>Prince of Songkla University</small>
    </div>
  </a>
  <nav class="tn-nav">
    <button class="tn-a active" onclick="gotoView('input',this)">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
    <button class="tn-a" onclick="gotoView('import',this)">‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤ Excel</button>
  </nav>
  <div class="tn-r">
    <div class="tn-av">A</div>
  </div>
</header>

<div class="app">
  <nav class="sidebar">
    <div class="sb-section">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>
    <div class="sb-item active" onclick="gotoView('input',null,this)">
      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 3.5a.5.5 0 00-1 0V7H3.5a.5.5 0 000 1H7v3.5a.5.5 0 001 0V8h3.5a.5.5 0 000-1H8V3.5z"/></svg>
      ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
    </div>
    <div class="sb-item" onclick="gotoView('import',null,this)">
      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 12l-4-4h2.5V4h3v4H12L8 12z"/><path d="M2 14h12v1.5H2z"/></svg>
      ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤ Excel
    </div>

    <div class="sb-section">‡∏´‡∏°‡∏ß‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>
    <div class="sb-item" onclick="gotoView('input',null,this);scrollToSection('sec1')">
      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7zm4-6a3 3 0 100-6 3 3 0 000 6z"/></svg>
      ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤
    </div>
    <div class="sb-item" onclick="gotoView('input',null,this);scrollToSection('sec2')">
      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M0 2a2 2 0 012-2h12a2 2 0 012 2v12a2 2 0 01-2 2H2a2 2 0 01-2-2V2zm5 3v2h6V5H5zm0 3v2h6V8H5zm0 3v2h6v-2H5zM3 5H1v2h2V5zm0 3H1v2h2V8zm0 3H1v2h2v-2z"/></svg>
      ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤
    </div>
    <div class="sb-item" onclick="gotoView('input',null,this);scrollToSection('sec3a')">
      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M4 11H2v3h2v-3zm5-4H7v7h2V7zm5-5v12h-2V2h2zm-2-1a1 1 0 00-1 1v12a1 1 0 001 1h2a1 1 0 001-1V2a1 1 0 00-1-1h-2zM6 7a1 1 0 00-1 1v7a1 1 0 001 1h2a1 1 0 001-1V8a1 1 0 00-1-1H6zM1 11a1 1 0 00-1 1v3a1 1 0 001 1h2a1 1 0 001-1v-3a1 1 0 00-1-1H1z"/></svg>
      ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô / ‡∏à‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤
    </div>
    <div class="sb-item" onclick="gotoView('input',null,this);scrollToSection('sec5')">
      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M8 8a3 3 0 100-6 3 3 0 000 6zm2-3a2 2 0 11-4 0 2 2 0 014 0zm4 8c0 1-1 1-1 1H3s-1 0-1-1 1-4 6-4 6 3 6 4z"/></svg>
      ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤
    </div>
    <div class="sb-item" onclick="gotoView('input',null,this);scrollToSection('sec6')">
      <svg viewBox="0 0 16 16" fill="currentColor"><path d="M1 14s-1 0-1-1 1-4 6-4 6 3 6 4-1 1-1 1H1zm5-6a3 3 0 100-6 3 3 0 000 6z"/></svg>
      ‡∏™‡∏´‡∏Å‡∏¥‡∏à / ‡∏ù‡∏∂‡∏Å‡∏á‡∏≤‡∏ô
    </div>
  </nav>

  <div class="content" id="content">

    <!-- ‚ïê‚ïê‚ïê‚ïê VIEW: ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‚ïê‚ïê‚ïê‚ïê -->
    <div class="view active" id="view-input">
      <div class="ph">
        <div class="ph-row">
          <div>
            <div class="ph-title">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</div>
            <div class="ph-sub">‡∏Å‡∏£‡∏≠‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï Dashboard ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</div>
          </div>
          <button class="btn btn-acc btn-sm" onclick="exportAllXlsx()">
            <svg viewBox="0 0 16 16"><path d="M8 12l-4-4h2.5V4h3v4H12L8 12z"/></svg>
            Export ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
          </button>
        </div>
      </div>

      <!-- Section 1 -->
      <div class="form-section" id="sec1">
        <div class="fs-header">
          <div class="fs-num">1</div>
          <div><div class="fs-title">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</div><div class="fs-sub">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î ‡∏ì ‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</div></div>
        </div>
        <div class="form-row c2">
          <div class="fg">
            <label>‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ <span class="req">*</span></label>
            <select id="f1yr"><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</option></select>
          </div>
          <div class="fg">
            <label>‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏≠‡∏Å <span class="req">*</span></label>
            <select id="f1mj">
              <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏≠‡∏Å</option>
              <option value="fin">‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô</option>
              <option value="mkt">‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£</option>
              <option value="hrm">‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå</option>
              <option value="log">‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏•‡∏à‡∏¥‡∏™‡∏ï‡∏¥‡∏Å‡∏™‡πå</option>
              <option value="bis">‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®‡∏ó‡∏≤‡∏á‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</option>
              <option value="mice">‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡∏ã‡πå</option>
            </select>
          </div>
        </div>
        <div class="fg">
          <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</label>
          <input type="number" id="f1total" placeholder="0" min="0">
          <div class="hint">‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏ó‡∏µ‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÉ‡∏ô‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ô‡∏µ‡πâ</div>
        </div>
        <div style="display:flex;align-items:center;gap:8px;padding:10px 0 2px;border-top:1px dashed var(--border);margin-top:8px">
          <span style="font-size:11.5px;font-weight:700;color:var(--text2)">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤:</span>
          <input type="number" id="customYrInput" placeholder="‡πÄ‡∏ä‡πà‡∏ô 2578" min="2530" max="2620"
            style="width:110px;padding:6px 9px;border:1.5px solid var(--border);border-radius:7px;font-family:inherit;font-size:12.5px;color:var(--text);outline:none"
            onkeydown="if(event.key==='Enter')addCustomYear()">
          <button class="btn btn-ghost btn-xs" onclick="addCustomYear()">‡πÄ‡∏û‡∏¥‡πà‡∏°</button>
          <span style="font-size:10.5px;color:var(--muted)">‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏à‡∏∞‡∏õ‡∏£‡∏≤‡∏Å‡∏è‡πÉ‡∏ô‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</span>
        </div>
        <div class="form-actions">
          <button class="btn btn-ghost btn-sm" onclick="clearFields(['f1yr','f1mj','f1total'])">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
          <button class="btn btn-acc btn-sm" onclick="saveForm1()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
        </div>
        <div class="saved-preview" id="sp1">
          <div class="sp-title"><span class="sp-dot"></span><span id="sp1t">‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô ‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ 2567</span></div>
          <div class="sp-vals">
            <div class="sp-item"><div class="sp-num" id="sp1v">287</div><div class="sp-lbl">‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤ (‡∏Ñ‡∏ô)</div></div>
          </div>
        </div>
      </div>

      <!-- Section 2 -->
      <div class="form-section" id="sec2">
        <div class="fs-header">
          <div class="fs-num">2</div>
          <div><div class="fs-title">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏õ‡∏µ</div><div class="fs-sub">‡πÅ‡∏ú‡∏ô‡∏£‡∏±‡∏ö / ‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå / ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô / ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß</div></div>
        </div>
        <div class="form-row c2">
          <div class="fg">
            <label>‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ <span class="req">*</span></label>
            <select id="f2yr"><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</option></select>
          </div>
          <div class="fg">
            <label>‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏≠‡∏Å <span class="req">*</span></label>
            <select id="f2mj">
              <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏≠‡∏Å</option>
              <option value="fin">‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô</option>
              <option value="mkt">‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£</option>
              <option value="hrm">‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå</option>
              <option value="log">‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏•‡∏à‡∏¥‡∏™‡∏ï‡∏¥‡∏Å‡∏™‡πå</option>
              <option value="bis">‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®‡∏ó‡∏≤‡∏á‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</option>
              <option value="mice">‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡∏ã‡πå</option>
            </select>
          </div>
        </div>
        <div class="form-row c5">
          <div class="fg"><label>‡πÅ‡∏ú‡∏ô‡∏£‡∏±‡∏ö</label><input type="number" id="f2pl" placeholder="0" min="0"><div class="hint">‡∏Ñ‡∏ô</div></div>
          <div class="fg"><label>‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå</label><input type="number" id="f2in" placeholder="0" min="0"><div class="hint">‡∏Ñ‡∏ô</div></div>
          <div class="fg"><label>‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</label><input type="number" id="f2co" placeholder="0" min="0"><div class="hint">‡∏Ñ‡∏ô</div></div>
          <div class="fg"><label>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß</label><input type="number" id="f2re" placeholder="0" min="0"><div class="hint">‡∏Ñ‡∏ô</div></div>
          <div class="fg"><label>‡πÑ‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß</label><input type="number" id="f2nr" placeholder="0" min="0"><div class="hint">‡∏Ñ‡∏ô</div></div>
        </div>
        <div class="form-actions">
          <button class="btn btn-ghost btn-sm" onclick="clearFields(['f2yr','f2mj','f2pl','f2in','f2co','f2re','f2nr'])">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
          <button class="btn btn-acc btn-sm" onclick="saveForm2()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
        </div>
        <div class="saved-preview" id="sp2">
          <div class="sp-title"><span class="sp-dot"></span><span id="sp2t">‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô ‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ 2567</span></div>
          <div class="sp-vals" id="sp2v">
            <div class="sp-item"><div class="sp-num">80</div><div class="sp-lbl">‡πÅ‡∏ú‡∏ô‡∏£‡∏±‡∏ö</div></div>
            <div class="sp-item"><div class="sp-num">122</div><div class="sp-lbl">‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå</div></div>
            <div class="sp-item"><div class="sp-num">80</div><div class="sp-lbl">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô</div></div>
            <div class="sp-item"><div class="sp-num">76</div><div class="sp-lbl">‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß</div></div>
            <div class="sp-item"><div class="sp-num">4</div><div class="sp-lbl">‡πÑ‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß</div></div>
          </div>
        </div>
      </div>

      <!-- Section 3A: ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô -->
      <div class="form-section" id="sec3a">
        <div class="fs-header">
          <div class="fs-num">3</div>
          <div>
            <div class="fs-title">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô (‡∏£‡∏≤‡∏¢‡∏õ‡∏µ)</div>
            <div class="fs-sub">‡πÉ‡∏ä‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏™‡πâ‡∏ô "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô" ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</div>
          </div>
        </div>
        <div style="background:#fef9c3;border:1px solid #fcd34d;border-radius:8px;padding:11px 14px;margin-bottom:14px;font-size:12px;color:#78350f;line-height:1.7">
          <strong>‚ö†Ô∏è ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡∏ï‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å "‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß" ‡πÉ‡∏ô‡∏™‡πà‡∏ß‡∏ô‡∏ó‡∏µ‡πà 2</strong><br>
          ‚Ä¢ <strong>‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß (‡∏™‡πà‡∏ß‡∏ô 2)</strong> = ‡∏ô‡∏±‡∏ö‡∏ï‡∏≠‡∏ô‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏ó‡∏≠‡∏°‡πÉ‡∏´‡∏°‡πà ‡∏õ‡∏µ‡∏ô‡∏±‡πâ‡∏ô‡πÜ ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ 1<br>
          ‚Ä¢ <strong>‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô (‡∏™‡πà‡∏ß‡∏ô 3)</strong> = ‡∏ô‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ó‡∏∏‡∏Å‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏£‡∏¥‡∏á ‡∏ì ‡∏õ‡∏µ‡∏ô‡∏±‡πâ‡∏ô (‡∏£‡∏ß‡∏° ‡∏õ‡∏µ 1‚Äì4)
        </div>
        <div class="form-row c2">
          <div class="fg">
            <label>‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ <span class="req">*</span></label>
            <select id="f3a_yr"><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</option></select>
          </div>
          <div class="fg">
            <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î <span class="req">*</span></label>
            <input type="number" id="f3a_enrolled" placeholder="‡πÄ‡∏ä‡πà‡∏ô 524" min="0">
            <div class="hint">‡∏ô‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ó‡∏∏‡∏Å‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà‡∏¢‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ô‡∏µ‡πâ (‡∏Ñ‡∏ô)</div>
          </div>
        </div>
        <div class="form-actions">
          <button class="btn btn-ghost btn-sm" onclick="clearFields(['f3a_yr','f3a_enrolled'])">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
          <button class="btn btn-acc btn-sm" onclick="saveForm3A()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
        </div>
        <div style="margin-top:14px">
          <div style="font-size:11.5px;font-weight:700;color:var(--text2);margin-bottom:7px">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß</div>
          <div class="tbl-wrap">
            <table><thead><tr><th>‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</th><th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô (‡∏Ñ‡∏ô)</th><th></th></tr></thead>
            <tbody id="tbody-enrolled"></tbody></table>
          </div>
        </div>
      </div>

      <!-- Section 3B: ‡∏à‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ -->
      <div class="form-section" id="sec3b">
        <div class="fs-header">
          <div class="fs-num" style="background:#059669">4</div>
          <div>
            <div class="fs-title">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ (‡∏£‡∏≤‡∏¢‡∏õ‡∏µ)</div>
            <div class="fs-sub">‡πÉ‡∏ä‡πâ‡πÅ‡∏™‡∏î‡∏á‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏™‡πâ‡∏ô "‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ó‡∏µ‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤" ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</div>
          </div>
        </div>
        <div style="background:#dcfce7;border:1px solid #86efac;border-radius:8px;padding:11px 14px;margin-bottom:14px;font-size:12px;color:#14532d;line-height:1.7">
          <strong>üìã ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏</strong><br>
          ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ó‡∏µ‡πà <strong>‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏à‡∏£‡∏¥‡∏á</strong> ‡πÉ‡∏ô‡∏õ‡∏µ‡∏ô‡∏±‡πâ‡∏ô (‡∏ú‡πà‡∏≤‡∏ô‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤ + ‡∏¢‡∏∑‡πà‡∏ô‡∏à‡∏ö)<br>
          ‡∏õ‡∏Å‡∏ï‡∏¥‡∏à‡∏∞‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô ‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏≤‡∏Å‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡∏à‡∏ö‡πÉ‡∏ô‡∏õ‡∏µ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô
        </div>
        <div class="form-row c2">
          <div class="fg">
            <label>‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ <span class="req">*</span></label>
            <select id="f3b_yr"><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</option></select>
          </div>
          <div class="fg">
            <label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ <span class="req">*</span></label>
            <input type="number" id="f3b_grad" placeholder="‡πÄ‡∏ä‡πà‡∏ô 420" min="0">
            <div class="hint">‡∏ô‡∏±‡∏ö‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ú‡∏π‡πâ‡∏ó‡∏µ‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÉ‡∏ô‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ô‡∏µ‡πâ (‡∏Ñ‡∏ô)</div>
          </div>
        </div>
        <div class="form-actions">
          <button class="btn btn-ghost btn-sm" onclick="clearFields(['f3b_yr','f3b_grad'])">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
          <button class="btn btn-acc btn-sm" onclick="saveForm3B()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
        </div>
        <div style="margin-top:14px">
          <div style="font-size:11.5px;font-weight:700;color:var(--text2);margin-bottom:7px">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß</div>
          <div class="tbl-wrap">
            <table><thead><tr><th>‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</th><th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ (‡∏Ñ‡∏ô)</th><th></th></tr></thead>
            <tbody id="tbody-graduated"></tbody></table>
          </div>
        </div>
      </div>

      <!-- Section 5: ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ -->
      <div class="form-section" id="sec5">
        <div class="fs-header">
          <div class="fs-num" style="background:#7c3aed">5</div>
          <div>
            <div class="fs-title">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ (‡πÅ‡∏¢‡∏Å‡∏£‡∏≤‡∏¢‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞)</div>
            <div class="fs-sub">‡πÉ‡∏ä‡πâ‡πÅ‡∏™‡∏î‡∏á Pie chart ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</div>
          </div>
        </div>
        <div style="background:#f0f9ff;border:1px solid #7dd3fc;border-radius:8px;padding:11px 14px;margin-bottom:14px;font-size:12px;color:#0c4a6e;line-height:1.7">
          <strong>üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∑‡∏≠ snapshot ‡∏ì ‡∏™‡∏¥‡πâ‡∏ô‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ô‡∏±‡πâ‡∏ô</strong><br>
          ‡πÉ‡∏™‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏∞‡∏™‡∏°‡∏ó‡∏∏‡∏Å‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ‡∏£‡∏ß‡∏°‡∏Å‡∏±‡∏ô ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ‡πÉ‡∏î‡∏ä‡∏±‡πâ‡∏ô‡∏õ‡∏µ‡∏´‡∏ô‡∏∂‡πà‡∏á
        </div>
        <div class="form-row c2" style="margin-bottom:12px">
          <div class="fg">
            <label>‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ <span class="req">*</span></label>
            <select id="f5yr"><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</option></select>
          </div>
        </div>
        <div style="background:var(--acc-ll);border-radius:9px;padding:14px 16px;margin-bottom:12px">
          <div style="font-size:11.5px;font-weight:700;color:var(--acc);margin-bottom:10px">‡∏Å‡∏£‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏¢‡∏Å‡∏ï‡∏≤‡∏°‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</div>
          <div class="form-row c3" style="margin-bottom:0">
            <div class="fg"><label>üü£ ‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤</label><input type="number" id="f5cur" placeholder="0" min="0"><div class="hint">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</div></div>
            <div class="fg"><label>üîµ ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</label><input type="number" id="f5grad" placeholder="0" min="0"><div class="hint">‡∏à‡∏ö‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏•‡πâ‡∏ß (‡∏™‡∏∞‡∏™‡∏°)</div></div>
            <div class="fg"><label>üü† ‡πÑ‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß</label><input type="number" id="f5nr" placeholder="0" min="0"><div class="hint">‡∏£‡∏±‡∏ö‡πÄ‡∏Ç‡πâ‡∏≤‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏°‡∏≤‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß</div></div>
          </div>
          <div class="form-row c3" style="margin-bottom:0;margin-top:10px">
            <div class="fg"><label>üü¢ ‡πÇ‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢</label><input type="number" id="f5tr" placeholder="0" min="0"><div class="hint">‡πÇ‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢‡∏≠‡∏≠‡∏Å‡πÑ‡∏õ‡∏™‡∏≤‡∏Ç‡∏≤‡∏≠‡∏∑‡πà‡∏ô</div></div>
            <div class="fg"><label>üü° ‡∏≠‡∏≠‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏±‡∏ô</label><input type="number" id="f5dr" placeholder="0" min="0"><div class="hint">‡∏•‡∏≤‡∏≠‡∏≠‡∏Å / ‡∏ñ‡∏π‡∏Å‡∏Ñ‡∏±‡∏î‡∏≠‡∏≠‡∏Å</div></div>
            <div class="fg"><label>üî¥ ‡∏û‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ / ‡∏•‡∏≤</label><input type="number" id="f5lv" placeholder="0" min="0"><div class="hint">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏à‡∏ö ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</div></div>
          </div>
        </div>
        <div class="form-actions">
          <button class="btn btn-ghost btn-sm" onclick="clearFields(['f5yr','f5cur','f5grad','f5nr','f5tr','f5dr','f5lv'])">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
          <button class="btn btn-acc btn-sm" onclick="saveForm5()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
        </div>
        <div style="margin-top:14px">
          <div style="font-size:11.5px;font-weight:700;color:var(--text2);margin-bottom:7px">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡πâ‡∏ß</div>
          <div class="tbl-wrap">
            <table id="tbl-status">
              <thead><tr><th>‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</th><th>üü£ ‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏¢‡∏π‡πà</th><th>üîµ ‡∏à‡∏ö‡πÅ‡∏•‡πâ‡∏ß</th><th>üü† ‡πÑ‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß</th><th>üü¢ ‡πÇ‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢</th><th>üü° ‡∏≠‡∏≠‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏±‡∏ô</th><th>üî¥ ‡∏û‡∏±‡∏Å/‡∏•‡∏≤</th><th></th></tr></thead>
              <tbody id="tbody-status"></tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Section 6: Coop/Intern -->
      <div class="form-section" id="sec6">
        <div class="fs-header">
          <div class="fs-num">6</div>
          <div><div class="fs-title">‡∏™‡∏´‡∏Å‡∏¥‡∏à‡∏®‡∏∂‡∏Å‡∏©‡∏≤ / ‡∏ù‡∏∂‡∏Å‡∏á‡∏≤‡∏ô</div><div class="fs-sub">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏≠‡∏≠‡∏Å‡∏ù‡∏∂‡∏Å‡∏á‡∏≤‡∏ô‡πÅ‡∏•‡∏∞‡∏™‡∏´‡∏Å‡∏¥‡∏à</div></div>
        </div>
        <div class="form-row c2">
          <div class="fg">
            <label>‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ <span class="req">*</span></label>
            <select id="f4yr"><option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</option></select>
          </div>
          <div class="fg">
            <label>‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏≠‡∏Å <span class="req">*</span></label>
            <select id="f4mj">
              <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏≠‡∏Å</option>
              <option value="fin">‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô</option>
              <option value="mkt">‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£</option>
              <option value="hrm">‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå</option>
              <option value="log">‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏•‡∏à‡∏¥‡∏™‡∏ï‡∏¥‡∏Å‡∏™‡πå</option>
              <option value="bis">‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®‡∏ó‡∏≤‡∏á‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</option>
              <option value="mice">‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡∏ã‡πå</option>
            </select>
          </div>
        </div>
        <div class="form-row c2">
          <div class="fg"><label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏™‡∏´‡∏Å‡∏¥‡∏à‡∏®‡∏∂‡∏Å‡∏©‡∏≤</label><input type="number" id="f4coop" placeholder="0" min="0"></div>
          <div class="fg"><label>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ù‡∏∂‡∏Å‡∏á‡∏≤‡∏ô</label><input type="number" id="f4intern" placeholder="0" min="0"></div>
        </div>
        <div class="form-actions">
          <button class="btn btn-ghost btn-sm" onclick="clearFields(['f4yr','f4mj','f4coop','f4intern'])">‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
          <button class="btn btn-acc btn-sm" onclick="saveForm4()">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
        </div>
      </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê VIEW: ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤ Excel ‚ïê‚ïê‚ïê‚ïê -->
    <div class="view" id="view-import">
      <div class="ph">
        <div class="ph-row">
          <div>
            <div class="ph-title">‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Excel</div>
            <div class="ph-sub">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå .xlsx ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</div>
          </div>
        </div>
      </div>

      <div class="form-section">
        <div class="fs-header">
          <div class="fs-num">üìÇ</div>
          <div><div class="fs-title">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå Excel</div><div class="fs-sub">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö .xlsx / .xls</div></div>
        </div>
        <div class="dz" id="dz" ondragover="dzO(event)" ondragleave="dzL()" ondrop="dzD(event)" onclick="document.getElementById('xlf').click()">
          <div class="dz-ico">üìä</div>
          <p>‡∏•‡∏≤‡∏Å‡πÑ‡∏ü‡∏•‡πå Excel ‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</p>
          <p>‡∏´‡∏£‡∏∑‡∏≠ <b>‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå</b></p>
          <p id="dz-fn" style="margin-top:6px;font-size:11px;color:var(--acc);font-weight:700"></p>
        </div>
        <input type="file" id="xlf" accept=".xlsx,.xls" style="display:none" onchange="handleXL(event)">

        <div style="background:var(--acc-ll);border:1px solid #c4b5fd;border-radius:9px;padding:14px 16px;margin-top:14px">
          <div style="font-size:12px;font-weight:800;color:var(--acc);margin-bottom:9px">üìã ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö Excel ‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö</div>
          <div style="font-size:11.5px;color:var(--text2);line-height:1.9">
            <strong>Sheet ‡∏ó‡∏µ‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö:</strong><br>
            ‚Ä¢ <code style="background:#fff;padding:1px 5px;border-radius:4px;font-size:10.5px;color:var(--acc)">Intake</code> ‚Äî ‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤: <span style="color:var(--text)">‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤, ‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏≠‡∏Å, ‡πÅ‡∏ú‡∏ô‡∏£‡∏±‡∏ö, ‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå, ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô, ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß, ‡πÑ‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß</span><br>
            ‚Ä¢ <code style="background:#fff;padding:1px 5px;border-radius:4px;font-size:10.5px;color:#059669">Enrolled</code> ‚Äî ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô: <span style="color:var(--text)">‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤, ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</span><br>
            ‚Ä¢ <code style="background:#fff;padding:1px 5px;border-radius:4px;font-size:10.5px;color:#059669">Graduated</code> ‚Äî ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤: <span style="color:var(--text)">‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤, ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</span><br>
            ‚Ä¢ <code style="background:#fff;padding:1px 5px;border-radius:4px;font-size:10.5px;color:#7c3aed">Status</code> ‚Äî ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤: <span style="color:var(--text)">‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤, ‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤, ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤, ‡πÑ‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß, ‡πÇ‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢, ‡∏≠‡∏≠‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏±‡∏ô, ‡∏û‡∏±‡∏Å/‡∏•‡∏≤</span><br>
            ‚Ä¢ <code style="background:#fff;padding:1px 5px;border-radius:4px;font-size:10.5px;color:#f97316">Coop</code> ‚Äî ‡∏™‡∏´‡∏Å‡∏¥‡∏à: <span style="color:var(--text)">‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤, ‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏≠‡∏Å, ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</span><br>
            ‚Ä¢ <code style="background:#fff;padding:1px 5px;border-radius:4px;font-size:10.5px;color:#f97316">Intern</code> ‚Äî ‡∏ù‡∏∂‡∏Å‡∏á‡∏≤‡∏ô: <span style="color:var(--text)">‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤, ‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏≠‡∏Å, ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</span>
          </div>
          <div style="display:flex;gap:8px;margin-top:12px;flex-wrap:wrap">
            <button class="btn btn-out btn-sm" onclick="exportTemplate()">
              <svg viewBox="0 0 16 16"><path d="M8 12l-4-4h2.5V4h3v4H12L8 12z"/></svg>
              ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î Template (‡∏ó‡∏∏‡∏Å Sheet)
            </button>
            <button class="btn btn-ghost btn-sm" onclick="exportTemplateStatus()">
              <svg viewBox="0 0 16 16"><path d="M8 12l-4-4h2.5V4h3v4H12L8 12z"/></svg>
              Template ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤
            </button>
          </div>
        </div>
      </div>

      <!-- Preview -->
      <div class="form-section" id="import-preview" style="display:none">
        <div class="fs-header">
          <div class="fs-num">üëÅ</div>
          <div><div class="fs-title">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤ (5 ‡πÅ‡∏ñ‡∏ß‡πÅ‡∏£‡∏Å)</div><div class="fs-sub" id="prev-sheet-name"></div></div>
        </div>
        <div id="prev-sheet-tabs" style="display:flex;gap:5px;flex-wrap:wrap;margin-bottom:10px"></div>
        <div class="tbl-wrap" id="prev-tbl"></div>
        <div style="background:#f0fdf4;border:1px solid #86efac;border-radius:8px;padding:10px 13px;margin-top:10px;font-size:11.5px;color:#14532d" id="import-summary"></div>
        <div class="form-actions">
          <button class="btn btn-ghost btn-sm" onclick="document.getElementById('import-preview').style.display='none'">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
          <button class="btn btn-acc btn-sm" id="confirm-import-btn">‚úì ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
        </div>
      </div>
    </div>

  </div>
</div>

<div id="toast"><span class="tdot" id="tdot"></span><span id="tmsg"></span></div>

<script>
/* ‚îÄ‚îÄ DATA ‚îÄ‚îÄ */
const MJ = {
  fin:  {name:'‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô',        short:'FIN'},
  mkt:  {name:'‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏™‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏£',      short:'MKT'},
  hrm:  {name:'‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏ó‡∏£‡∏±‡∏û‡∏¢‡∏≤‡∏Å‡∏£‡∏°‡∏ô‡∏∏‡∏©‡∏¢‡πå',  short:'HRM'},
  log:  {name:'‡πÇ‡∏•‡∏à‡∏¥‡∏™‡∏ï‡∏¥‡∏Å‡∏™‡πå‡πÅ‡∏•‡∏∞‡πÇ‡∏ã‡πà‡∏≠‡∏∏‡∏õ‡∏ó‡∏≤‡∏ô',   short:'LSM'},
  bis:  {name:'‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≤‡∏£‡∏™‡∏ô‡πÄ‡∏ó‡∏®‡∏ó‡∏≤‡∏á‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à',    short:'BIS'},
  mice: {name:'‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÑ‡∏°‡∏ã‡πå (MICE)',      short:'MICE'},
};

let DB = {
  fin:  [[2562,60,88,52,50,2],[2563,60,118,71,70,1],[2564,60,118,71,72,1],[2565,70,139,57,56,1],[2566,70,199,80,79,1],[2567,70,122,80,76,4]],
  mkt:  [[2563,60,104,71,69,2],[2564,60,96,74,71,3],[2565,70,134,71,67,4],[2566,70,143,78,76,2],[2567,70,139,93,90,3]],
  hrm:  [[2563,60,106,73,71,2],[2564,60,131,73,72,1],[2565,70,104,56,54,2],[2566,70,102,96,94,2],[2567,70,132,97,94,3]],
  log:  [[2563,60,113,79,77,2],[2564,60,107,85,81,4],[2565,70,139,75,74,1],[2566,70,145,100,99,1],[2567,70,120,90,90,0]],
  bis:  [[2563,60,102,70,67,3],[2564,60,101,89,88,1],[2565,70,121,76,73,3],[2566,70,142,99,98,1],[2567,70,123,91,87,4]],
  mice: [[2563,60,114,77,76,1],[2564,60,105,73,72,1],[2565,70,116,76,75,1],[2566,70,108,78,77,1],[2567,70,118,80,80,0]],
};

let TREND_DB = {
  2563:{enrolled:434,graduated:434},
  2564:{enrolled:458,graduated:458},
  2565:{enrolled:389,graduated:389},
  2566:{enrolled:529,graduated:0},
  2567:{enrolled:524,graduated:0},
};

const STATUS_DATA = {
  2567:[{label:'‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤',val:532,color:'#8b5cf6'},{label:'‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤',val:518,color:'#3b82f6'},{label:'‡πÑ‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß',val:14,color:'#f97316'},{label:'‡πÇ‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢',val:8,color:'#22c55e'},{label:'‡∏≠‡∏≠‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏±‡∏ô',val:21,color:'#eab308'},{label:'‡∏û‡∏±‡∏Å/‡∏•‡∏≤',val:3,color:'#ef4444'}],
  2566:[{label:'‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤',val:495,color:'#8b5cf6'},{label:'‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤',val:480,color:'#3b82f6'},{label:'‡πÑ‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß',val:12,color:'#f97316'},{label:'‡πÇ‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢',val:6,color:'#22c55e'},{label:'‡∏≠‡∏≠‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏±‡∏ô',val:18,color:'#eab308'},{label:'‡∏û‡∏±‡∏Å/‡∏•‡∏≤',val:2,color:'#ef4444'}],
  2565:[{label:'‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤',val:460,color:'#8b5cf6'},{label:'‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤',val:445,color:'#3b82f6'},{label:'‡πÑ‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß',val:10,color:'#f97316'},{label:'‡πÇ‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢',val:5,color:'#22c55e'},{label:'‡∏≠‡∏≠‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏±‡∏ô',val:15,color:'#eab308'},{label:'‡∏û‡∏±‡∏Å/‡∏•‡∏≤',val:1,color:'#ef4444'}],
};

let COOP_DATA = [
  {key:'fin',v:[9,5,7,7,23,12,22]},{key:'hrm',v:[13,5,2,6,6,10,32]},
  {key:'mice',v:[12,17,30,10,18,15,7]},{key:'log',v:[16,25,21,38,60,57,49]},
  {key:'mkt',v:[38,34,11,25,22,37,30]},{key:'bis',v:[8,22,17,26,33,48,34]},
];
const COOP_YRS=[2562,2563,2564,2565,2566,2567,2568];

let INTERN_DATA = [
  {key:'fin',v:[29,28,25,40,41]},{key:'mkt',v:[58,45,68,65,65]},
  {key:'hrm',v:[26,33,27,39,40]},{key:'log',v:[51,52,60,66,70]},
  {key:'bis',v:[38,36,45,48,50]},{key:'mice',v:[41,36,38,52,60]},
];
const INTERN_YRS=[2563,2564,2565,2566,2567];

/* ‚îÄ‚îÄ YEAR SELECTS ‚îÄ‚îÄ */
const DEFAULT_YRS = [2577,2576,2575,2574,2573,2572,2571,2570,2569,2568,2567,2566,2565,2564,2563,2562,2561,2560,2559,2558,2557,2556,2555];
const ALL_YR_IDS = ['f1yr','f2yr','f3a_yr','f3b_yr','f5yr','f4yr'];
let extraYrs = [];

function populateYearSelects() {
  const allYrs = [...new Set([...DEFAULT_YRS,...extraYrs])].sort((a,b)=>b-a);
  ALL_YR_IDS.forEach(id=>{
    const sel = document.getElementById(id);
    if(!sel) return;
    const cur = sel.value;
    sel.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</option>';
    allYrs.forEach(y=>{
      const o=document.createElement('option');
      o.value=y; o.textContent=y;
      sel.appendChild(o);
    });
    if(cur) sel.value=cur;
  });
}

function addCustomYear() {
  const inp = document.getElementById('customYrInput');
  const yr = parseInt(inp.value);
  if(!yr||yr<2530||yr>2620){toast('‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á (2530‚Äì2620)','#ef4444');return;}
  if(!extraYrs.includes(yr)&&!DEFAULT_YRS.includes(yr)) extraYrs.push(yr);
  populateYearSelects();
  inp.value='';
  toast('‚úì ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ '+yr+' ‡πÅ‡∏•‡πâ‡∏ß');
}

/* ‚îÄ‚îÄ NAV ‚îÄ‚îÄ */
function gotoView(name, navEl, sbEl) {
  document.querySelectorAll('.view').forEach(v=>v.classList.remove('active'));
  document.getElementById('view-'+name).classList.add('active');
  if(navEl){document.querySelectorAll('.tn-a').forEach(e=>e.classList.remove('active'));navEl.classList.add('active');}
  if(sbEl){document.querySelectorAll('.sb-item').forEach(e=>e.classList.remove('active'));sbEl.classList.add('active');}
}

function scrollToSection(id) {
  setTimeout(()=>{
    const el=document.getElementById(id);
    if(el) el.scrollIntoView({behavior:'smooth',block:'start'});
  },80);
}

/* ‚îÄ‚îÄ FORMS ‚îÄ‚îÄ */
function clearFields(ids){ids.forEach(id=>{const el=document.getElementById(id);if(el)el.value='';})}

function saveForm1() {
  const yr=+document.getElementById('f1yr').value, mid=document.getElementById('f1mj').value;
  if(!yr||!mid){toast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏≠‡∏Å','#ef4444');return;}
  const v=+document.getElementById('f1total').value||0;
  document.getElementById('sp1t').textContent=MJ[mid].name+' ‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ '+yr;
  document.getElementById('sp1v').textContent=v.toLocaleString();
  toast('‚úì ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
}

function saveForm2() {
  const yr=+document.getElementById('f2yr').value, mid=document.getElementById('f2mj').value;
  if(!yr||!mid){toast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏≠‡∏Å','#ef4444');return;}
  const pl=+document.getElementById('f2pl').value||0, inn=+document.getElementById('f2in').value||0,
        co=+document.getElementById('f2co').value||0, re=+document.getElementById('f2re').value||0,
        nr=+document.getElementById('f2nr').value||0;
  const rows=DB[mid]||[]; const idx=rows.findIndex(r=>r[0]===yr);
  const row=[yr,pl,inn,co,re,nr];
  if(idx>=0) rows[idx]=row; else rows.push(row);
  DB[mid]=rows;
  document.getElementById('sp2t').textContent=MJ[mid].name+' ‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ '+yr;
  document.getElementById('sp2v').innerHTML=[['‡πÅ‡∏ú‡∏ô‡∏£‡∏±‡∏ö',pl],['‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå',inn],['‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô',co],['‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß',re],['‡πÑ‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß',nr]]
    .map(([l,v])=>`<div class="sp-item"><div class="sp-num">${v}</div><div class="sp-lbl">${l}</div></div>`).join('');
  toast('‚úì ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
}

function saveForm3A(){
  const yr=+document.getElementById('f3a_yr').value;
  const v=+document.getElementById('f3a_enrolled').value||0;
  if(!yr){toast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤','#ef4444');return;}
  if(!TREND_DB[yr]) TREND_DB[yr]={enrolled:0,graduated:0};
  TREND_DB[yr].enrolled=v;
  renderEnrolledTable();
  toast('‚úì ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô ‡∏õ‡∏µ '+yr+' = '+v.toLocaleString()+' ‡∏Ñ‡∏ô');
}

function saveForm3B(){
  const yr=+document.getElementById('f3b_yr').value;
  const v=+document.getElementById('f3b_grad').value||0;
  if(!yr){toast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤','#ef4444');return;}
  if(!TREND_DB[yr]) TREND_DB[yr]={enrolled:0,graduated:0};
  TREND_DB[yr].graduated=v;
  renderGraduatedTable();
  toast('‚úì ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ‡∏õ‡∏µ '+yr+' = '+v.toLocaleString()+' ‡∏Ñ‡∏ô');
}

function saveForm5(){
  const yr=+document.getElementById('f5yr').value;
  if(!yr){toast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤','#ef4444');return;}
  STATUS_DATA[yr]=[
    {label:'‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤',val:+document.getElementById('f5cur').value||0,color:'#8b5cf6'},
    {label:'‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤', val:+document.getElementById('f5grad').value||0,color:'#3b82f6'},
    {label:'‡πÑ‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß',   val:+document.getElementById('f5nr').value||0,color:'#f97316'},
    {label:'‡πÇ‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢',         val:+document.getElementById('f5tr').value||0,color:'#22c55e'},
    {label:'‡∏≠‡∏≠‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏±‡∏ô',      val:+document.getElementById('f5dr').value||0,color:'#eab308'},
    {label:'‡∏û‡∏±‡∏Å/‡∏•‡∏≤',          val:+document.getElementById('f5lv').value||0,color:'#ef4444'},
  ].filter(x=>x.val>0);
  renderStatusTable();
  toast('‚úì ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ‡∏õ‡∏µ '+yr+' ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
}

function saveForm4() {
  const yr=+document.getElementById('f4yr').value, mid=document.getElementById('f4mj').value;
  if(!yr||!mid){toast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡πÅ‡∏•‡∏∞‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏≠‡∏Å','#ef4444');return;}
  const coop=+document.getElementById('f4coop').value||0;
  const intern=+document.getElementById('f4intern').value||0;
  const ci=COOP_DATA.findIndex(c=>c.key===mid);
  if(ci>=0){const yi=COOP_YRS.indexOf(yr);if(yi>=0)COOP_DATA[ci].v[yi]=coop;}
  const ii=INTERN_DATA.findIndex(c=>c.key===mid);
  if(ii>=0){const yi=INTERN_YRS.indexOf(yr);if(yi>=0)INTERN_DATA[ii].v[yi]=intern;}
  toast('‚úì ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏´‡∏Å‡∏¥‡∏à/‡∏ù‡∏∂‡∏Å‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
}

/* ‚îÄ‚îÄ TABLE RENDERS ‚îÄ‚îÄ */
function renderEnrolledTable(){
  const yrs=Object.keys(TREND_DB).map(Number).sort((a,b)=>b-a);
  document.getElementById('tbody-enrolled').innerHTML=yrs.map(y=>`<tr>
    <td><strong>${y}</strong></td>
    <td>${(TREND_DB[y].enrolled||0).toLocaleString()} ‡∏Ñ‡∏ô</td>
    <td><button class="btn btn-ghost btn-xs" onclick="delTrend(${y},'enrolled')">‡∏•‡∏ö</button></td>
  </tr>`).join('');
}
function renderGraduatedTable(){
  const yrs=Object.keys(TREND_DB).map(Number).sort((a,b)=>b-a);
  document.getElementById('tbody-graduated').innerHTML=yrs.map(y=>`<tr>
    <td><strong>${y}</strong></td>
    <td>${(TREND_DB[y].graduated||0).toLocaleString()} ‡∏Ñ‡∏ô</td>
    <td><button class="btn btn-ghost btn-xs" onclick="delTrend(${y},'graduated')">‡∏•‡∏ö</button></td>
  </tr>`).join('');
}
function delTrend(yr,field){
  if(TREND_DB[yr])TREND_DB[yr][field]=0;
  renderEnrolledTable();renderGraduatedTable();
}
function renderStatusTable(){
  const yrs=Object.keys(STATUS_DATA).map(Number).sort((a,b)=>b-a);
  document.getElementById('tbody-status').innerHTML=yrs.map(yr=>{
    const d=STATUS_DATA[yr]||[];
    const g=k=>d.find(x=>x.label.includes(k))?.val||0;
    return `<tr>
      <td><strong>${yr}</strong></td>
      <td>${g('‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤').toLocaleString()}</td>
      <td>${g('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à').toLocaleString()}</td>
      <td>${g('‡πÑ‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß').toLocaleString()}</td>
      <td>${g('‡πÇ‡∏≠‡∏ô').toLocaleString()}</td>
      <td>${g('‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏±‡∏ô').toLocaleString()}</td>
      <td>${g('‡∏û‡∏±‡∏Å').toLocaleString()}</td>
      <td><button class="btn btn-ghost btn-xs" onclick="delStatus(${yr})">‡∏•‡∏ö</button></td>
    </tr>`;
  }).join('');
}
function delStatus(yr){delete STATUS_DATA[yr];renderStatusTable();}

/* ‚îÄ‚îÄ EXCEL IMPORT ‚îÄ‚îÄ */
const MJ_MAP={
  'Finance_Investment':'fin','fin':'fin','FIN':'fin',
  'Marketing_Communication':'mkt','mkt':'mkt','MKT':'mkt',
  'HR_Management':'hrm','hrm':'hrm','HRM':'hrm',
  'Logistics':'log','log':'log','LOG':'log','LSM':'log',
  'Business_IT':'bis','bis':'bis','BIS':'bis',
  'MICE_Management':'mice','mice':'mice','MICE':'mice',
  'Intake':'intake','intake':'intake',
  'Enrolled':'enrolled','enrolled':'enrolled',
  'Graduated':'graduated','graduated':'graduated',
  'Status':'status','status':'status',
  'Coop':'coop','coop':'coop','‡∏™‡∏´‡∏Å‡∏¥‡∏à':'coop',
  'Intern':'intern','intern':'intern','‡∏ù‡∏∂‡∏Å‡∏á‡∏≤‡∏ô':'intern',
};

function dzO(e){e.preventDefault();document.getElementById('dz').classList.add('drag');}
function dzL(){document.getElementById('dz').classList.remove('drag');}
function dzD(e){e.preventDefault();document.getElementById('dz').classList.remove('drag');if(e.dataTransfer.files[0])procXL(e.dataTransfer.files[0]);}
function handleXL(e){if(e.target.files[0])procXL(e.target.files[0]);}

let pendingImport=null;

function procXL(file){
  if(!/\.(xlsx|xls)$/i.test(file.name)){toast('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏ä‡πâ‡πÑ‡∏ü‡∏•‡πå .xlsx ‡∏´‡∏£‡∏∑‡∏≠ .xls','#ef4444');return;}
  document.getElementById('dz-fn').textContent='üìÑ '+file.name+' ('+(file.size/1024).toFixed(1)+' KB)';
  const reader=new FileReader();
  reader.onload=ev=>{
    try{
      const wb=XLSX.read(ev.target.result,{type:'array'});
      pendingImport={wb};
      const tabs=document.getElementById('prev-sheet-tabs');
      tabs.innerHTML=wb.SheetNames.map((sn,i)=>`
        <button style="padding:5px 12px;border-radius:6px;border:1px solid var(--border);background:${i===0?'var(--acc-l)':'#fff'};font-size:11.5px;font-weight:${i===0?700:500};color:${i===0?'var(--acc)':'var(--text2)'};cursor:pointer;font-family:Sarabun,sans-serif"
          onclick="showSheetPreview('${sn}',this)">${sn}</button>
      `).join('');
      showSheetPreview(wb.SheetNames[0],tabs.querySelector('button'));
      const detected=wb.SheetNames.map(sn=>{
        const k=MJ_MAP[sn]||MJ_MAP[sn.trim()];
        const rows=XLSX.utils.sheet_to_json(wb.Sheets[sn],{header:1}).filter(r=>r.length>0);
        return k?`‚úì <strong>${sn}</strong> (${Math.max(0,rows.length-1)} ‡πÅ‡∏ñ‡∏ß)`:null;
      }).filter(Boolean);
      document.getElementById('import-summary').innerHTML='<strong>‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏µ‡πà‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏î‡πâ:</strong> '+detected.join(', ');
      document.getElementById('import-preview').style.display='block';
      document.getElementById('confirm-import-btn').onclick=confirmImport;
    }catch(err){toast('‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ: '+err.message,'#ef4444');}
  };
  reader.readAsArrayBuffer(file);
}

function showSheetPreview(sn,tabEl){
  if(!pendingImport)return;
  document.querySelectorAll('#prev-sheet-tabs button').forEach(b=>{
    b.style.background='#fff';b.style.color='var(--text2)';b.style.fontWeight=500;b.style.borderColor='var(--border)';
  });
  if(tabEl){tabEl.style.background='var(--acc-l)';tabEl.style.color='var(--acc)';tabEl.style.fontWeight=700;}
  document.getElementById('prev-sheet-name').textContent='Sheet: '+sn;
  const rows=XLSX.utils.sheet_to_json(pendingImport.wb.Sheets[sn],{header:1}).slice(0,6);
  if(!rows.length){document.getElementById('prev-tbl').innerHTML='<p style="padding:12px;color:var(--muted)">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</p>';return;}
  let html='<table><thead><tr>'+rows[0].map(k=>`<th>${k||''}</th>`).join('')+'</tr></thead><tbody>';
  rows.slice(1).forEach(r=>{html+='<tr>'+rows[0].map((_,i)=>`<td>${r[i]??''}</td>`).join('')+'</tr>';});
  html+='</tbody></table>';
  document.getElementById('prev-tbl').innerHTML=html;
}

function confirmImport(){
  if(!pendingImport)return;
  const {wb}=pendingImport;
  let cnt=0;
  wb.SheetNames.forEach(sn=>{
    const k=MJ_MAP[sn]||MJ_MAP[sn.trim()];
    if(!k)return;
    const data=XLSX.utils.sheet_to_json(wb.Sheets[sn],{defval:''});
    if(k==='intake'||MJ[k]){
      data.forEach(row=>{
        const yr=parseInt(row['‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤']||row['‡∏õ‡∏µ']||row['year']||0);
        const rawKey=String(row['‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏≠‡∏Å']||row['major']||k);
        const mid=MJ_MAP[rawKey.trim()]||rawKey;
        if(!yr||yr<2530||yr>2620||!MJ[mid])return;
        const r=[yr,+row['‡πÅ‡∏ú‡∏ô‡∏£‡∏±‡∏ö']||0,+row['‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå']||+row['‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå']||0,+row['‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô']||0,+row['‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß']||0,+row['‡πÑ‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß']||0];
        if(!DB[mid])DB[mid]=[];
        const idx=DB[mid].findIndex(x=>x[0]===yr);
        if(idx>=0)DB[mid][idx]=r;else DB[mid].push(r);
        cnt++;
      });
    }
    if(k==='enrolled'){data.forEach(row=>{const yr=parseInt(row['‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤']||row['‡∏õ‡∏µ']||row['year']||0);const v=+row['‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô']||+row['‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô']||+row['enrolled']||0;if(!yr||yr<2530||yr>2620)return;if(!TREND_DB[yr])TREND_DB[yr]={enrolled:0,graduated:0};TREND_DB[yr].enrolled=v;cnt++;});renderEnrolledTable();}
    if(k==='graduated'){data.forEach(row=>{const yr=parseInt(row['‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤']||row['‡∏õ‡∏µ']||row['year']||0);const v=+row['‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤']||+row['‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤']||+row['graduated']||0;if(!yr||yr<2530||yr>2620)return;if(!TREND_DB[yr])TREND_DB[yr]={enrolled:0,graduated:0};TREND_DB[yr].graduated=v;cnt++;});renderGraduatedTable();}
    if(k==='status'){data.forEach(row=>{const yr=parseInt(row['‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤']||row['‡∏õ‡∏µ']||row['year']||0);if(!yr||yr<2530||yr>2620)return;STATUS_DATA[yr]=[{label:'‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤',val:+row['‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤']||+row['‡∏¢‡∏±‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏≠‡∏¢‡∏π‡πà']||0,color:'#8b5cf6'},{label:'‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤',val:+row['‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤']||0,color:'#3b82f6'},{label:'‡πÑ‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß',val:+row['‡πÑ‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß']||0,color:'#f97316'},{label:'‡πÇ‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢',val:+row['‡πÇ‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢']||0,color:'#22c55e'},{label:'‡∏≠‡∏≠‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏±‡∏ô',val:+row['‡∏≠‡∏≠‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏±‡∏ô']||0,color:'#eab308'},{label:'‡∏û‡∏±‡∏Å/‡∏•‡∏≤',val:+row['‡∏û‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤']||+row['‡∏û‡∏±‡∏Å/‡∏•‡∏≤']||0,color:'#ef4444'}].filter(x=>x.val>0);cnt++;});renderStatusTable();}
    if(k==='coop'){data.forEach(row=>{const yr=parseInt(row['‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤']||row['‡∏õ‡∏µ']||row['year']||0);const mid=MJ_MAP[String(row['‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏≠‡∏Å']||row['major']||'').trim()];const v=+row['‡∏à‡∏≥‡∏ô‡∏ß‡∏ô']||+row['coop']||0;if(!yr||!mid)return;const ci=COOP_DATA.findIndex(c=>c.key===mid);const yi=COOP_YRS.indexOf(yr);if(ci>=0&&yi>=0){COOP_DATA[ci].v[yi]=v;cnt++;}});}
    if(k==='intern'){data.forEach(row=>{const yr=parseInt(row['‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤']||row['‡∏õ‡∏µ']||row['year']||0);const mid=MJ_MAP[String(row['‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏≠‡∏Å']||row['major']||'').trim()];const v=+row['‡∏à‡∏≥‡∏ô‡∏ß‡∏ô']||+row['intern']||0;if(!yr||!mid)return;const ii=INTERN_DATA.findIndex(c=>c.key===mid);const yi=INTERN_YRS.indexOf(yr);if(ii>=0&&yi>=0){INTERN_DATA[ii].v[yi]=v;cnt++;}});}
  });
  pendingImport=null;
  document.getElementById('import-preview').style.display='none';
  toast(`‚úì ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ${cnt} ‡πÅ‡∏ñ‡∏ß`);
}

/* ‚îÄ‚îÄ EXPORT ‚îÄ‚îÄ */
function exportAllXlsx(){
  const wb=XLSX.utils.book_new();
  // Intake per major
  Object.entries(DB).forEach(([mid,rows])=>{
    const ws=XLSX.utils.aoa_to_sheet([['‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤','‡πÅ‡∏ú‡∏ô‡∏£‡∏±‡∏ö','‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå','‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô','‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß','‡πÑ‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß'],...rows.sort((a,b)=>a[0]-b[0])]);
    XLSX.utils.book_append_sheet(wb,ws,MJ[mid].short);
  });
  // Enrolled
  const enrYrs=Object.keys(TREND_DB).map(Number).sort((a,b)=>a-b);
  XLSX.utils.book_append_sheet(wb,XLSX.utils.aoa_to_sheet([['‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤','‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î'],...enrYrs.map(y=>[y,TREND_DB[y].enrolled||0])]),'Enrolled');
  // Graduated
  XLSX.utils.book_append_sheet(wb,XLSX.utils.aoa_to_sheet([['‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤','‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤'],...enrYrs.map(y=>[y,TREND_DB[y].graduated||0])]),'Graduated');
  // Status
  const stYrs=Object.keys(STATUS_DATA).map(Number).sort((a,b)=>a-b);
  XLSX.utils.book_append_sheet(wb,XLSX.utils.aoa_to_sheet([
    ['‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤','‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤','‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤','‡πÑ‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß','‡πÇ‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢','‡∏≠‡∏≠‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏±‡∏ô','‡∏û‡∏±‡∏Å/‡∏•‡∏≤'],
    ...stYrs.map(yr=>{const d=STATUS_DATA[yr]||[];const g=k=>d.find(x=>x.label.includes(k))?.val||0;return[yr,g('‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤'),g('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à'),g('‡πÑ‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß'),g('‡πÇ‡∏≠‡∏ô'),g('‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏±‡∏ô'),g('‡∏û‡∏±‡∏Å')];})
  ]),'Status');
  // Coop
  XLSX.utils.book_append_sheet(wb,XLSX.utils.aoa_to_sheet([['‡∏™‡∏≤‡∏Ç‡∏≤',...COOP_YRS,'‡∏£‡∏ß‡∏°'],...COOP_DATA.map(c=>[MJ[c.key]?.name||c.key,...c.v,c.v.reduce((a,b)=>a+b,0)])]),'Coop');
  // Intern
  XLSX.utils.book_append_sheet(wb,XLSX.utils.aoa_to_sheet([['‡∏™‡∏≤‡∏Ç‡∏≤',...INTERN_YRS,'‡∏£‡∏ß‡∏°'],...INTERN_DATA.map(c=>[MJ[c.key]?.name||c.key,...c.v,c.v.reduce((a,b)=>a+b,0)])]),'Intern');
  XLSX.writeFile(wb,'student_data_export.xlsx');
  toast('‚úì Export ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å Sheet ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
}

function exportTemplate(){
  const wb=XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb,XLSX.utils.aoa_to_sheet([['‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤','‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏≠‡∏Å','‡πÅ‡∏ú‡∏ô‡∏£‡∏±‡∏ö','‡∏™‡∏±‡∏°‡∏†‡∏≤‡∏©‡∏ì‡πå','‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô','‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß','‡πÑ‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß'],[2567,'fin',70,122,80,76,4],[2567,'mkt',70,139,93,90,3]]),'Intake');
  XLSX.utils.book_append_sheet(wb,XLSX.utils.aoa_to_sheet([['‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤','‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î'],[2567,524],[2566,529]]),'Enrolled');
  XLSX.utils.book_append_sheet(wb,XLSX.utils.aoa_to_sheet([['‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤','‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤'],[2567,0],[2566,0]]),'Graduated');
  XLSX.utils.book_append_sheet(wb,XLSX.utils.aoa_to_sheet([['‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤','‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤','‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤','‡πÑ‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß','‡πÇ‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢','‡∏≠‡∏≠‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏±‡∏ô','‡∏û‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤'],[2567,532,518,14,8,21,3]]),'Status');
  XLSX.utils.book_append_sheet(wb,XLSX.utils.aoa_to_sheet([['‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤','‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏≠‡∏Å','‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏™‡∏´‡∏Å‡∏¥‡∏à'],[2567,'fin',12],[2567,'mkt',37]]),'Coop');
  XLSX.utils.book_append_sheet(wb,XLSX.utils.aoa_to_sheet([['‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤','‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏≠‡∏Å','‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤‡∏ù‡∏∂‡∏Å‡∏á‡∏≤‡∏ô'],[2567,'fin',41],[2567,'mkt',65]]),'Intern');
  XLSX.writeFile(wb,'template_student_data.xlsx');
  toast('‚úì ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î Template ‡∏Ñ‡∏£‡∏ö 6 Sheet ‡πÅ‡∏•‡πâ‡∏ß');
}

function exportTemplateStatus(){
  const wb=XLSX.utils.book_new();
  XLSX.utils.book_append_sheet(wb,XLSX.utils.aoa_to_sheet([['‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤','‡∏¢‡∏±‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤','‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤','‡πÑ‡∏°‡πà‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ï‡∏±‡∏ß','‡πÇ‡∏≠‡∏ô‡∏¢‡πâ‡∏≤‡∏¢','‡∏≠‡∏≠‡∏Å‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏±‡∏ô','‡∏û‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤'],[2567,532,518,14,8,21,3],[2566,495,480,12,6,18,2]]),'Status');
  XLSX.utils.book_append_sheet(wb,XLSX.utils.aoa_to_sheet([['‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤','‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î'],[2567,524],[2566,529]]),'Enrolled');
  XLSX.utils.book_append_sheet(wb,XLSX.utils.aoa_to_sheet([['‡∏õ‡∏µ‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤','‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤'],[2567,0],[2566,0]]),'Graduated');
  XLSX.writeFile(wb,'template_student_status.xlsx');
  toast('‚úì ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î Template ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏ô‡∏±‡∏Å‡∏®‡∏∂‡∏Å‡∏©‡∏≤ ‡πÅ‡∏•‡πâ‡∏ß');
}

/* ‚îÄ‚îÄ TOAST ‚îÄ‚îÄ */
let _tt;
function toast(msg,color='#7c3aed'){
  document.getElementById('tdot').style.background=color;
  document.getElementById('tmsg').textContent=msg;
  const el=document.getElementById('toast');
  el.classList.add('show');
  clearTimeout(_tt);
  _tt=setTimeout(()=>el.classList.remove('show'),2800);
}

/* ‚îÄ‚îÄ INIT ‚îÄ‚îÄ */
populateYearSelects();
renderEnrolledTable();
renderGraduatedTable();
renderStatusTable();
</script>
</body>
</html>