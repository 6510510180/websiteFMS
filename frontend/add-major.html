<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>Add Major | FMS Admin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@300;400;500;600;700&family=Lexend:wght@400;500;600;700;800&display=swap" rel="stylesheet">
<style>
    /* ‚îÄ‚îÄ SIDEBAR (QA-Dashboard style) ‚îÄ‚îÄ */
    :root {
      --purple:#6B3FA0;--purple-dark:#4A2870;--purple-light:#F3EEFF;--purple-mid:#E8DEFF;
      --accent:#9B6DD1;--bg-base:#F7F5FA;--white:#FFFFFF;--text-main:#181117;--text-sub:#64748B;
      --border-col:#EDE8F5;--red:#EF4444;--red-bg:#FEE2E2;--sidebar-w:240px;--topbar-h:64px;
    }
    .sidebar-qa {
      width:var(--sidebar-w);background:var(--white);height:100vh;position:fixed;
      left:0;top:0;display:flex;flex-direction:column;border-right:1px solid var(--border-col);z-index:100;
    }
    .sidebar-brand{padding:20px 20px 16px;border-bottom:1px solid var(--border-col);}
    .sidebar-brand-title{font-family:'Lexend',sans-serif;font-size:16px;font-weight:700;color:var(--text-main);letter-spacing:-0.2px;}
    .sidebar-brand-sub{font-size:11.5px;color:var(--purple);font-weight:500;margin-top:2px;}
    .sidebar-section-label{padding:20px 20px 6px;font-size:10px;font-weight:700;color:var(--text-sub);text-transform:uppercase;letter-spacing:1.2px;}
    .sidebar-nav-qa{flex:1;padding:8px 12px;display:flex;flex-direction:column;gap:2px;overflow-y:auto;}
    .nav-item-qa{
      display:flex;align-items:center;gap:10px;
      padding:10px 12px;border-radius:8px;
      font-size:13.5px;font-weight:500;color:var(--text-sub);
      text-decoration:none;transition:all 0.18s;cursor:pointer;user-select:none;
    }
    .nav-item-qa:hover{background:var(--purple-light);color:var(--purple);}
    .nav-item-qa.active{background:var(--purple-light);color:var(--purple);font-weight:600;}
    .nav-icon-qa{width:18px;height:18px;flex-shrink:0;opacity:0.75;}
    .nav-item-qa.active .nav-icon-qa,.nav-item-qa:hover .nav-icon-qa{opacity:1;}
    .sidebar-footer-qa{padding:12px;border-top:1px solid var(--border-col);}
    .sidebar-footer-qa .nav-item-qa{color:var(--red);}
    .sidebar-footer-qa .nav-item-qa:hover{background:var(--red-bg);color:#DC2626;}
    svg{display:block;}


:root {
  --primary: #7c3aed;
  --primary-light: #ede9fe;
  --sidebar-w: 230px;
  --text: #1e1b2e;
  --muted: #6b7280;
  --border: #e5e7eb;
  --bg: #f5f4fa;
}
* { box-sizing: border-box; margin: 0; padding: 0; }
body { font-family: 'Noto Sans Thai', 'Segoe UI', sans-serif; background: var(--bg); display: flex; min-height: 100vh; }

/* ‚îÄ‚îÄ SIDEBAR ‚îÄ‚îÄ */
.sidebar {
  width: var(--sidebar-w);
  background: #fff;
  height: 100vh;
  position: fixed;
  left: 0; top: 0;
  display: flex;
  flex-direction: column;
  box-shadow: 2px 0 16px rgba(0,0,0,0.07);
  border-radius: 0 20px 20px 0;
  z-index: 100;
  overflow: hidden;
}
.sidebar-logo { padding: 22px 24px 18px; border-bottom: 1px solid var(--border); flex-shrink: 0; }
.sidebar-logo .brand { font-size: 20px; font-weight: 700; color: var(--primary); letter-spacing: -0.5px; }
.sidebar-logo .brand-sub { font-size: 11px; color: var(--muted); margin-top: 1px; }
.sidebar-nav { flex: 1; padding: 16px 14px; display: flex; flex-direction: column; gap: 4px; overflow-y: auto; }
.nav-item {
  display: flex; align-items: center; gap: 12px;
  padding: 12px 14px; border-radius: 12px; cursor: pointer;
  font-size: 14px; font-weight: 500; color: var(--muted);
  text-decoration: none;
  transition: background .18s, color .18s, transform .18s;
  user-select: none;
}
.nav-item:hover { background: var(--primary-light); color: var(--primary); transform: translateX(3px); }
.nav-item.active { background: var(--primary-light); color: var(--primary); font-weight: 600; }
.nav-item .nav-icon { font-size: 16px; width: 20px; text-align: center; flex-shrink: 0; }
.sidebar-footer { padding: 14px; border-top: 1px solid var(--border); flex-shrink: 0; }
.sidebar-footer .nav-item { color: #ef4444; }
.sidebar-footer .nav-item:hover { background: #fee2e2; color: #dc2626; transform: translateX(3px); }

/* ‚îÄ‚îÄ MAIN ‚îÄ‚îÄ */
/* ‚îÄ‚îÄ MAIN ‚îÄ‚îÄ */
.main {
  margin-left: var(--sidebar-w);
  flex: 1;
  padding: 32px;
  display: flex;
  flex-direction: column;
  min-width: 0;
}
.page-header small { color: #999; font-size: 13px; }
.page-header h2 { margin: 4px 0; font-size: 22px; color: var(--text); }
.page-header p { font-size: 13px; color: var(--muted); margin-bottom: 20px; }

.card { background: white; border-radius: 16px; padding: 20px 22px; box-shadow: 0 4px 12px rgba(0,0,0,0.05); margin-bottom: 20px; }
.card-title { font-size: 18px; font-weight: 600; margin-bottom: 6px; }
.form-grid-2 { display: grid; grid-template-columns: repeat(2, minmax(0,1fr)); gap: 16px 24px; margin-top: 12px; margin-bottom: 16px; }
.field label { display: block; font-size: 13px; margin-bottom: 4px; color: #555; }
.field input, .field textarea, .field select {
  width: 100%; padding: 10px 12px; border-radius: 10px;
  border: 1px solid #ddd; background: #faf7ff;
  outline: none; font-size: 14px; font-family: inherit;
}
.field input:focus, .field textarea:focus { border-color: var(--primary); background: #fff; box-shadow: 0 0 0 2px rgba(124,58,237,0.15); }

.editor-block { margin-top: 12px; }
.editor-label { font-size: 13px; margin-bottom: 4px; color: #555; }
.fake-toolbar { display: flex; gap: 12px; padding: 6px 10px; border-radius: 10px 10px 0 0; background: var(--primary-light); color: var(--primary); font-size: 13px; }
.fake-toolbar span { cursor: default; }
.editor-textarea { width: 100%; min-height: 100px; border-radius: 0 0 10px 10px; border: 1px solid #e2d4ff; border-top: none; padding: 10px 12px; resize: vertical; outline: none; background: #faf7ff; font-size: 14px; font-family: inherit; }

.upload-box { border: 2px dashed #d6c5ff; border-radius: 12px; padding: 30px; text-align: center; color: #9c78e6; font-size: 13px; margin-top: 8px; margin-bottom: 20px; background: #fcf9ff; }

.plan-grid { display: grid; grid-template-columns: repeat(4, minmax(0,1fr)); gap: 16px; margin-top: 12px; }
.plan-card { border-radius: 14px; background: #f7f0ff; padding: 0; overflow: hidden; }
.plan-card .fake-toolbar { border-radius: 14px 14px 0 0; }
.plan-card .editor-textarea { border-radius: 0 0 14px 14px; border-color: #e2d4ff; }

.footer-actions { display: flex; justify-content: flex-end; gap: 10px; margin-top: 16px; }
.btn { border-radius: 999px; padding: 9px 22px; border: none; cursor: pointer; font-size: 14px; font-family: inherit; font-weight: 500; transition: opacity .15s; }
.btn:hover { opacity: 0.88; }
.btn-secondary { background: #ffdddd; color: #b33939; }
.btn-primary { background: var(--primary); color: white; box-shadow: 0 5px 14px rgba(124,58,237,0.3); }
#message { margin-top: 8px; font-size: 13px; }
  </style>
</head>
<body>
<aside class="sidebar-qa">
  <div class="sidebar-brand">
    <div class="sidebar-brand-title">FMS Admin</div>
    <div class="sidebar-brand-sub">PSU Faculty of Management</div>
  </div>
  <div class="sidebar-section-label">‡πÄ‡∏°‡∏ô‡∏π‡∏´‡∏•‡∏±‡∏Å</div>
  <nav class="sidebar-nav-qa">
    <a class="nav-item-qa" href="dashboard.html">
      <svg class="nav-icon-qa" viewBox="0 0 20 20" fill="currentColor"><path d="M2 10.5a1.5 1.5 0 113 0v6a1.5 1.5 0 01-3 0v-6zM6 10.333v5.43a2 2 0 001.106 1.79l.05.025A4 4 0 008.943 18h5.416a2 2 0 001.962-1.608l1.2-6A2 2 0 0015.56 8H12V4a2 2 0 00-2-2 1 1 0 00-1 1v.667a4 4 0 01-.8 2.4L6.8 7.933a4 4 0 00-.8 2.4z"/></svg>
      ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î
    </a>
    <a class="nav-item-qa" href="study-plan.html">
      <svg class="nav-icon-qa" viewBox="0 0 20 20" fill="currentColor"><path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"/><path fill-rule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"/></svg>
      ‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤
    </a>
    <a class="nav-item-qa active" href="course-list.html">
      <svg class="nav-icon-qa" viewBox="0 0 20 20" fill="currentColor"><path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3zM3.31 9.397L5 10.12v4.102a8.969 8.969 0 00-1.05-.174 1 1 0 01-.89-.89 11.115 11.115 0 01.25-3.762zM9.3 16.573A9.026 9.026 0 007 14.935v-3.957l1.818.78a3 3 0 002.364 0l5.508-2.361a11.026 11.026 0 01.25 3.762 1 1 0 01-.89.89 8.968 8.968 0 00-5.35 2.524 1 1 0 01-1.4 0zM6 18a1 1 0 001-1v-2.065a8.935 8.935 0 00-2-.712V17a1 1 0 001 1z"/></svg>
      ‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£
    </a>
    <a class="nav-item-qa" href="qa-dashboard.html">
      <svg class="nav-icon-qa" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M6.267 3.455a3.066 3.066 0 001.745-.723 3.066 3.066 0 013.976 0 3.066 3.066 0 001.745.723 3.066 3.066 0 012.812 2.812c.051.643.304 1.254.723 1.745a3.066 3.066 0 010 3.976 3.066 3.066 0 00-.723 1.745 3.066 3.066 0 01-2.812 2.812 3.066 3.066 0 00-1.745.723 3.066 3.066 0 01-3.976 0 3.066 3.066 0 00-1.745-.723 3.066 3.066 0 01-2.812-2.812 3.066 3.066 0 00-.723-1.745 3.066 3.066 0 010-3.976 3.066 3.066 0 00.723-1.745 3.066 3.066 0 012.812-2.812zm7.44 5.252a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>
      ‡∏õ‡∏£‡∏∞‡∏Å‡∏±‡∏ô‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤
    </a>
  </nav>
  <div class="sidebar-footer-qa">
    <a class="nav-item-qa" href="login.html" id="logoutBtn">
      <svg class="nav-icon-qa" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M3 3a1 1 0 00-1 1v12a1 1 0 102 0V4a1 1 0 00-1-1zm10.293 9.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L14.586 9H7a1 1 0 100 2h7.586l-1.293 1.293z" clip-rule="evenodd"/></svg>
      ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
    </a>
  </div>
</aside>


<!-- ‚îÄ‚îÄ MAIN ‚îÄ‚îÄ -->
<div class="main">
  <div class="page-header">
    <small>‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î / ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£ / ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</small>
    <h2>‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤</h2>
    <p>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£ ‡πÄ‡∏û‡∏¥‡πà‡∏° ‡∏•‡∏ö ‡πÅ‡∏•‡∏∞‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤‡πÉ‡∏ô‡∏Ñ‡∏ì‡∏∞‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</p>
  </div>

  <form id="majorForm">
    <div class="card">
      <div class="card-title">‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏™‡∏≠‡∏ô</div>
      <div class="form-grid-2">
        <div class="field">
          <label>‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£ (‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢)</label>
          <input type="text" id="major_name_th" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏•‡∏á‡∏ó‡∏∏‡∏ô" required />
        </div>
        <div class="field">
          <label>‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£ (‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©)</label>
          <input type="text" id="major_name_en" placeholder="‡πÄ‡∏ä‡πà‡∏ô Finance" />
        </div>
      </div>

      <div class="editor-block">
        <div class="editor-label">‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤</div>
        <div class="fake-toolbar"><span>B</span><span>I</span><span>U</span><span>‚Ä¢</span><span>1.</span><span>üîó</span></div>
        <textarea id="intro" class="editor-textarea" placeholder="‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤ ‡πÄ‡∏ä‡πà‡∏ô ‡∏à‡∏∏‡∏î‡πÄ‡∏î‡πà‡∏ô ‡∏£‡∏≤‡∏¢‡∏ß‡∏¥‡∏ä‡∏≤‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç ‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πâ‡∏≤‡∏´‡∏°‡∏≤‡∏¢ ‡∏Ø‡∏•‡∏Ø"></textarea>
      </div>

      <div style="margin-top:18px;">
        <div class="editor-label">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</div>
        <div class="upload-box">
          ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå ‡∏´‡∏£‡∏∑‡∏≠‡∏ß‡∏≤‡∏á<br>
          <small>PNG, JPG, GIF ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 10MB</small>
        </div>
        <input type="text" id="image_url" placeholder="(‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£) ‡πÉ‡∏™‡πà URL ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û ‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ü‡∏•‡πå"
          style="width:100%; padding:10px 12px; border-radius:10px; border:1px solid #ddd; background:#faf7ff; font-family:inherit;">
      </div>

      <div class="editor-block">
        <div class="editor-label">‡πÅ‡∏ô‡∏ß‡∏ó‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏≠‡∏≤‡∏ä‡∏µ‡∏û</div>
        <div class="fake-toolbar"><span>B</span><span>I</span><span>U</span><span>‚Ä¢</span><span>1.</span><span>üîó</span></div>
        <textarea id="career_path" class="editor-textarea" placeholder="‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏ô‡∏±‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•, ‡∏ô‡∏±‡∏Å‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î ‡∏Ø‡∏•‡∏Ø"></textarea>
      </div>
    </div>

    <div class="card">
      <div class="card-title">‡πÇ‡∏Ñ‡∏£‡∏á‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡∏®‡∏∂‡∏Å‡∏©‡∏≤</div>
      <p style="font-size:13px;color:var(--muted);margin-top:0;margin-bottom:12px;">‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ‡πÅ‡∏ö‡πà‡∏á‡πÄ‡∏õ‡πá‡∏ô ‡πÅ‡∏ú‡∏ô‡∏õ‡∏µ 1‚Äì4 ‡∏´‡∏£‡∏∑‡∏≠ ‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏ß‡∏¥‡∏ä‡∏≤ ‡∏ï‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£</p>

      <div class="plan-grid">
        <div class="plan-card">
          <div class="fake-toolbar"><span>B</span><span>I</span><span>U</span><span>‚Ä¢</span><span>1.</span><span>üîó</span></div>
          <textarea id="plan_1" class="editor-textarea" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÅ‡∏ú‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà 1 ‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏°‡∏ß‡∏î‡∏ß‡∏¥‡∏ä‡∏≤‡πÅ‡∏Å‡∏ô"></textarea>
        </div>
        <div class="plan-card">
          <div class="fake-toolbar"><span>B</span><span>I</span><span>U</span><span>‚Ä¢</span><span>1.</span><span>üîó</span></div>
          <textarea id="plan_2" class="editor-textarea" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÅ‡∏ú‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà 2 ‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏°‡∏ß‡∏î‡∏ß‡∏¥‡∏ä‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å"></textarea>
        </div>
        <div class="plan-card">
          <div class="fake-toolbar"><span>B</span><span>I</span><span>U</span><span>‚Ä¢</span><span>1.</span><span>üîó</span></div>
          <textarea id="plan_3" class="editor-textarea" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÅ‡∏ú‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà 3"></textarea>
        </div>
        <div class="plan-card">
          <div class="fake-toolbar"><span>B</span><span>I</span><span>U</span><span>‚Ä¢</span><span>1.</span><span>üîó</span></div>
          <textarea id="plan_4" class="editor-textarea" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡πÅ‡∏ú‡∏ô‡∏õ‡∏µ‡∏ó‡∏µ‡πà 4"></textarea>
        </div>
      </div>

      <div class="footer-actions">
        <button type="button" class="btn btn-secondary" onclick="history.back()">Cancel</button>
        <button type="submit" class="btn btn-primary">Finish</button>
      </div>
      <div id="message"></div>
    </div>
  </form>
</div>

<script>
const BASE_URL = "https://websitefms.onrender.com";
const API = BASE_URL + "/api";

const token = localStorage.getItem("user");
if (!token) { alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏Å‡πà‡∏≠‡∏ô"); window.location.href = "login.html"; }

document.getElementById("logoutBtn").addEventListener("click", (e) => {
  e.preventDefault();
  localStorage.removeItem("user");
  window.location.href = "login.html";
});

const params = new URLSearchParams(window.location.search);
const courseId = params.get("courseId");
const majorId = params.get("majorId");

if (!courseId) alert("‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡∏•‡∏±‡∏Å‡∏™‡∏π‡∏ï‡∏£‡∏ó‡∏µ‡πà‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡πÇ‡∏¢‡∏á (courseId)");
if (majorId) loadMajor(majorId);

async function loadMajor(id) {
  try {
    const res = await fetch(`${API}/majors/${id}`, { headers: { "Authorization": `Bearer ${token}` } });
    if (res.status === 401) { localStorage.removeItem("user"); window.location.href = "login.html"; return; }
    const m = await res.json();
    if (!res.ok) { alert(m.message || "‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤‡πÑ‡∏î‡πâ"); return; }
    document.getElementById("major_name_th").value = m.name_th || "";
    document.getElementById("major_name_en").value = m.name_en || "";
    document.getElementById("intro").value = m.intro || "";
    document.getElementById("image_url").value = m.image_url || "";
    document.getElementById("career_path").value = m.career_path || "";
    document.getElementById("plan_1").value = m.plan_1 || "";
    document.getElementById("plan_2").value = m.plan_2 || "";
    document.getElementById("plan_3").value = m.plan_3 || "";
    document.getElementById("plan_4").value = m.plan_4 || "";
    document.querySelector(".btn.btn-primary").textContent = "Update";
  } catch { alert("‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ (‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≤‡∏Ç‡∏≤)"); }
}

const form = document.getElementById("majorForm");
const msg = document.getElementById("message");

form.addEventListener("submit", async (e) => {
  e.preventDefault();
  msg.textContent = ""; msg.style.color = "red";
  const body = {
    course_id: Number(courseId),
    name_th: document.getElementById("major_name_th").value.trim(),
    name_en: document.getElementById("major_name_en").value.trim(),
    intro: document.getElementById("intro").value.trim(),
    image_url: document.getElementById("image_url").value.trim(),
    career_path: document.getElementById("career_path").value.trim(),
    plan_1: document.getElementById("plan_1").value.trim(),
    plan_2: document.getElementById("plan_2").value.trim(),
    plan_3: document.getElementById("plan_3").value.trim(),
    plan_4: document.getElementById("plan_4").value.trim()
  };
  try {
    const url = majorId ? `${API}/majors/${majorId}` : `${API}/majors`;
    const method = majorId ? "PUT" : "POST";
    const res = await fetch(url, { method, headers: { "Content-Type": "application/json", "Authorization": `Bearer ${token}` }, body: JSON.stringify(body) });
    if (res.status === 401) { localStorage.removeItem("user"); window.location.href = "login.html"; return; }
    const data = await res.json();
    if (!res.ok) { msg.textContent = data.message || (majorId ? "‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à" : "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à"); return; }
    msg.style.color = "green";
    msg.textContent = majorId ? "‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à" : "‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≤‡∏Ç‡∏≤‡∏ß‡∏¥‡∏ä‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
    window.location.href = `course-info.html?courseId=${courseId}`;
  } catch { msg.textContent = "‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ"; }
});
</script>
</body>
</html>